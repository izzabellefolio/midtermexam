<div class="container py-4 align-items-center justify-content-center min-vh-100 d-flex flex-column">
  <div class="row gx-4 gy-4 justify-content-center">
    <!-- Search + Weather Column -->
    <div class="col-12 col-lg-7">
      <div class="card shadow-sm p-3">
        <div class="d-flex align-items-center mb-3">
          <h3 class="mb-0 me-3">Weather Search</h3>
          <small class="text-muted">Quickly find current weather by city</small>
        </div>

        <div class="mb-3">
          <div class="input-group">
            <input
              [(ngModel)]="city"
              placeholder="Enter city name (e.g. London)"
              class="form-control"
              (keyup.enter)="getWeather()"
              aria-label="City name"
            />
            <button class="btn btn-outline-secondary" type="button" (click)="city=''; errorMessage=''; weatherData=null">
              Clear
            </button>
            <button class="btn btn-primary" (click)="getWeather()" [disabled]="loading">
              <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
              {{ loading ? 'Searching...' : 'Get Weather' }}
            </button>
          </div>
        </div>

        <div *ngIf="errorMessage" class="alert alert-danger py-2">{{ errorMessage }}</div>

        <div *ngIf="!weatherData && !errorMessage" class="text-muted small mb-2">Search for a city to see current weather.</div>

        <div *ngIf="weatherData" class="weather-card card border-0">
          <div class="card-body d-flex flex-column flex-md-row align-items-center gap-3">
            <div class="text-center text-md-start">
              <img
                class="weather-icon mb-2"
                [src]="weatherData.current.weather_icons[0]"
                [alt]="weatherData.current.weather_descriptions[0] || 'Weather icon'"
              />
              <h4 class="mb-0">{{ weatherData.location.name }}, <small class="text-muted">{{ weatherData.location.country }}</small></h4>
              <div class="text-muted small">{{ weatherData.current.weather_descriptions[0] }}</div>
            </div>

            <div class="ms-md-4 flex-grow-1">
              <div class="row text-center text-md-start">
                <div class="col-4 col-sm-3">
                  <div class="stat-label">Temp</div>
                  <div class="stat-value">{{ weatherData.current.temperature }} °C</div>
                </div>
                <div class="col-4 col-sm-3">
                  <div class="stat-label">Feels</div>
                  <div class="stat-value">{{ weatherData.current.feelslike }} °C</div>
                </div>
                <div class="col-4 col-sm-3">
                  <div class="stat-label">Humidity</div>
                  <div class="stat-value">{{ weatherData.current.humidity }}%</div>
                </div>
                <div class="col-12 col-sm-3 mt-2 mt-sm-0">
                  <button
                    class="btn btn-outline-success"
                    (click)="addToFavorites()"
                    [disabled]="favorites.includes(weatherData.location.name + ', ' + weatherData.location.country)"
                  >
                    Save City
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> 
    </div> 
    <div class="col-12 col-lg-5">
      <div class="card shadow-sm p-3 h-100">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0">Saved Cities</h5>
        </div>

        <div *ngIf="favorites?.length === 0" class="py-4 text-center text-muted">
          <div class="mb-2">No saved cities yet</div>
          <small>Add cities from the search results to pin them here.</small>
        </div>

        <ul class="list-group list-group-flush">
          <li
            *ngFor="let fav of favorites"
            class="list-group-item d-flex justify-content-between align-items-center fav-item"
          >
            <div class="fav-label" role="button" (click)="selectFavorite(fav)">{{ fav }}</div>
            <div class="d-flex gap-2">
              <button class="btn btn-sm btn-danger" (click)="removeFromFavorites(fav)">Remove</button>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>